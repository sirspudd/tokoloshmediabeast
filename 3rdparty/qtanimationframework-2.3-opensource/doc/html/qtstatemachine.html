<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- qtanimationframework-2.3-opensource/src/qtstatemachine.cpp -->
<head>
  <title>QtStateMachine Class Reference</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qt-logo.png" align="left" width="57" height="67" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a></td>
</tr></table><h1 class="title">QtStateMachine Class Reference<br /><span class="small-subtitle">[<a href="http://doc.trolltech.com/4.4/qtcore.html">QtCore</a> module]</span>
</h1>
<p>The QtStateMachine class provides a hierarchical finite state machine. <a href="#details">More...</a></p>
<pre> #include &lt;QtStateMachine&gt;</pre><p>Inherits <a href="http://doc.trolltech.com/4.4/qobject.html">QObject</a>.</p>
<p><b>Note:</b> All the functions in this class are <a href="http://doc.trolltech.com/4.4/threads.html">reentrant</a>.</p>
<ul>
<li><a href="qtstatemachine-members.html">List of all members, including inherited members</a></li>
</ul>
<a name="public-types"></a>
<h3>Public Types</h3>
<ul>
<li><div class="fn"/>enum <b><a href="qtstatemachine.html#Error-enum">Error</a></b> { NoError, NoInitialStateError, NoDefaultStateInHistoryState }</li>
</ul>
<a name="properties"></a>
<h3>Properties</h3>
<ul>
<li><div class="fn"/><b><a href="qtstatemachine.html#errorState-prop">errorState</a></b> : QtAbstractState *</li>
<li><div class="fn"/><b><a href="qtstatemachine.html#errorString-prop">errorString</a></b> : const QString</li>
<li><div class="fn"/><b><a href="qtstatemachine.html#initialState-prop">initialState</a></b> : QtAbstractState *</li>
<li><div class="fn"/><b><a href="qtstatemachine.html#rootState-prop">rootState</a></b> : QtState * const</li>
</ul>
<ul>
<li><div class="fn"/>1 property inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#properties">QObject</a></li>
</ul>
<a name="public-functions"></a>
<h3>Public Functions</h3>
<ul>
<li><div class="fn"/><b><a href="qtstatemachine.html#QtStateMachine">QtStateMachine</a></b> ( QObject * <i>parent</i> = 0 )</li>
<li><div class="fn"/><b><a href="qtstatemachine.html#dtor.QtStateMachine">~QtStateMachine</a></b> ()</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#addState">addState</a></b> ( QtAbstractState * <i>state</i> )</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#clearError">clearError</a></b> ()</li>
<li><div class="fn"/>Error <b><a href="qtstatemachine.html#error">error</a></b> () const</li>
<li><div class="fn"/>QtAbstractState * <b><a href="qtstatemachine.html#errorState-prop">errorState</a></b> () const</li>
<li><div class="fn"/>QString <b><a href="qtstatemachine.html#errorString-prop">errorString</a></b> () const</li>
<li><div class="fn"/>QtAbstractState::RestorePolicy <b><a href="qtstatemachine.html#globalRestorePolicy">globalRestorePolicy</a></b> () const</li>
<li><div class="fn"/>QtAbstractState * <b><a href="qtstatemachine.html#initialState-prop">initialState</a></b> () const</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#postEvent">postEvent</a></b> ( QEvent * <i>event</i>, int <i>delay</i> = 0 )</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#removeState">removeState</a></b> ( QtAbstractState * <i>state</i> )</li>
<li><div class="fn"/>QtState * <b><a href="qtstatemachine.html#rootState-prop">rootState</a></b> () const</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#errorState-prop">setErrorState</a></b> ( QtAbstractState * <i>state</i> )</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#setGlobalRestorePolicy">setGlobalRestorePolicy</a></b> ( QtAbstractState::RestorePolicy <i>restorePolicy</i> )</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#initialState-prop">setInitialState</a></b> ( QtAbstractState * <i>state</i> )</li>
<li><div class="fn"/>QList&lt;QtAbstractState *&gt; <b><a href="qtstatemachine.html#states">states</a></b> () const</li>
</ul>
<ul>
<li><div class="fn"/>29 public functions inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#public-functions">QObject</a></li>
</ul>
<a name="public-slots"></a>
<h3>Public Slots</h3>
<ul>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#start">start</a></b> ()</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#stop">stop</a></b> ()</li>
</ul>
<ul>
<li><div class="fn"/>1 public slot inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#public-slots">QObject</a></li>
</ul>
<a name="signals"></a>
<h3>Signals</h3>
<ul>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#animationsFinished">animationsFinished</a></b> ()</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#finished">finished</a></b> ()</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#started">started</a></b> ()</li>
<li><div class="fn"/>void <b><a href="qtstatemachine.html#stopped">stopped</a></b> ()</li>
</ul>
<ul>
<li><div class="fn"/>1 signal inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#signals">QObject</a></li>
</ul>
<h3>Additional Inherited Members</h3>
<ul>
<li><div class="fn"/>1 public type inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#public-variables">QObject</a></li>
<li><div class="fn"/>4 static public members inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#static-public-members">QObject</a></li>
<li><div class="fn"/>7 protected functions inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#protected-functions">QObject</a></li>
<li><div class="fn"/>2 protected variables inherited from <a href="http://doc.trolltech.com/4.4/qobject.html#protected-variables">QObject</a></li>
</ul>
<a name="details"></a>
<hr />
<h2>Detailed Description</h2>
<p>The QtStateMachine class provides a hierarchical finite state machine.</p>
<p>The QtStateMachine class provides a hierarchical finite state machine based on <a href="http://www.wisdom.weizmann.ac.il/~dharel/SCANNED.PAPERS/Statecharts.pdf">Statecharts</a> concepts and notation. QtStateMachine is part of <a href="statemachine-api.html">The State Machine Framework</a>.</p>
<p>A state machine manages a set of states (<a href="qtabstractstate.html">QtAbstractState</a> objects) and transitions (<a href="qtabstracttransition.html">QtAbstractTransition</a> objects) between those states; the states and the transitions collectively define a state graph. Once a state graph has been defined, the state machine can execute it. QtStateMachine's execution algorithm is based on the <a href="http://www.w3.org/TR/scxml/">State Chart XML (SCXML)</a> algorithm.</p>
<p>The <a href="qtstate.html">QtState</a> class provides a state that you can use to set properties and invoke methods on QObjects when the state is entered or exited. This is typically used in conjunction with <a href="http://doc.trolltech.com/4.4/signalsandslots.html">signals</a>; the signals determine the flow of the state graph, whereas the states' property assignments and method invocations are the actions.</p>
<p>Use the <a href="qtstatemachine.html#addState">addState</a>() function to add a state to the state machine; alternatively, pass the machine's <a href="qtstatemachine.html#rootState-prop">rootState</a>() to the state constructor. Use the <a href="qtstatemachine.html#removeState">removeState</a>() function to remove a state from the state machine.</p>
<p>The following snippet shows a state machine that will finish when a button is clicked:</p>
<pre> QPushButton button;

 QtStateMachine machine;
 QtState *s1 = new QtState();
 s1-&gt;assignProperty(&amp;button, &quot;text&quot;, &quot;Click me&quot;);

 QtFinalState *s2 = new QtFinalState();
 s1-&gt;addTransition(&amp;button, SIGNAL(clicked()), s2);

 machine.addState(s1);
 machine.addState(s2);
 machine.setInitialState(s1);
 machine.start();</pre>
<p>The <a href="qtstatemachine.html#initialState-prop">setInitialState</a>() function sets the state machine's initial state; this state is entered when the state machine is started.</p>
<p>The <a href="qtstatemachine.html#start">start</a>() function starts the state machine. The state machine executes asynchronously, i.e&#x2e; you need to run an event loop in order for it to make progress. The <a href="qtstatemachine.html#started">started</a>() signal is emitted when the state machine has entered the initial state.</p>
<p>The state machine processes events and takes transitions until a top-level final state is entered; the state machine then emits the <a href="qtstatemachine.html#finished">finished</a>() signal.</p>
<p>The <a href="qtstatemachine.html#stop">stop</a>() function stops the state machine. The <a href="qtstatemachine.html#stopped">stopped</a>() signal is emitted when the state machine has stopped.</p>
<p>The <a href="qtstatemachine.html#postEvent">postEvent</a>() function posts an event to the state machine. This is useful when you are using custom events to trigger transitions.</p>
<p>The <a href="qtstatemachine.html#rootState-prop">rootState</a>() function returns the state machine's root state. All top-level states have the root state as their parent.</p>
<p>See also <a href="qtabstractstate.html">QtAbstractState</a> and <a href="qtabstracttransition.html">QtAbstractTransition</a>.</p>
<hr />
<h2>Member Type Documentation</h2>
<h3 class="fn"><a name="Error-enum"></a>enum QtStateMachine::Error</h3>
<p>This enum type defines errors that can occur in the state machine at run time. When the state machine encounters an unrecoverable error at run time, it will set the error code returned by <a href="qtstatemachine.html#error">error</a>(), the error message returned by <a href="qtstatemachine.html#errorString-prop">errorString</a>(), and enter an error state based on the context of the error.</p>
<p><table border="1" cellpadding="2" cellspacing="1" width="100%">
<tr><th width="25%">Constant</th><th width="15%">Value</th><th width="60%">Description</th></tr>
<tr><td valign="top"><tt>QtStateMachine::NoError</tt></td><td align="center" valign="top"><tt>0</tt></td><td valign="top">No error has occurred.</td></tr>
<tr><td valign="top"><tt>QtStateMachine::NoInitialStateError</tt></td><td align="center" valign="top"><tt>1</tt></td><td valign="top">The machine has entered a <a href="qtstate.html">QtState</a> with children which does not have an initial state set. The context of this error is the state which is missing an initial state.</td></tr>
<tr><td valign="top"><tt>QtStateMachine::NoDefaultStateInHistoryState</tt></td><td align="center" valign="top"><tt>2</tt></td><td valign="top">The machine has entered a <a href="qthistorystate.html">QtHistoryState</a> which does not have a default state set. The context of this error is the <a href="qthistorystate.html">QtHistoryState</a> which is missing a default state.</td></tr>
</table></p>
<p>See also <a href="qtstatemachine.html#errorState-prop">setErrorState</a>().</p>
<hr />
<h2>Property Documentation</h2>
<h3 class="fn"><a name="errorState-prop"></a>errorState : <a href="qtabstractstate.html">QtAbstractState</a> *</h3>
<p>This property holds the error state of this state machine.</p>
<p>Access functions:</p>
<ul>
<li><div class="fn"/><b>QtAbstractState * errorState () const</b></li>
<li><div class="fn"/><b>void setErrorState ( QtAbstractState * <i>state</i> )</b></li>
</ul>
<h3 class="fn"><a name="errorString-prop"></a>errorString : const <a href="http://doc.trolltech.com/4.4/qstring.html">QString</a></h3>
<p>This property holds the error string of this state machine.</p>
<p>Access functions:</p>
<ul>
<li><div class="fn"/><b>QString errorString () const</b></li>
</ul>
<h3 class="fn"><a name="initialState-prop"></a>initialState : <a href="qtabstractstate.html">QtAbstractState</a> *</h3>
<p>This property holds the initial state of this state machine.</p>
<p>Access functions:</p>
<ul>
<li><div class="fn"/><b>QtAbstractState * initialState () const</b></li>
<li><div class="fn"/><b>void setInitialState ( QtAbstractState * <i>state</i> )</b></li>
</ul>
<h3 class="fn"><a name="rootState-prop"></a>rootState : <a href="qtstate.html">QtState</a> * const</h3>
<p>This property holds the root state of this state machine.</p>
<p>Access functions:</p>
<ul>
<li><div class="fn"/><b>QtState * rootState () const</b></li>
</ul>
<hr />
<h2>Member Function Documentation</h2>
<h3 class="fn"><a name="QtStateMachine"></a>QtStateMachine::QtStateMachine ( <a href="http://doc.trolltech.com/4.4/qobject.html">QObject</a> * <i>parent</i> = 0 )</h3>
<p>Constructs a new state machine with the given <i>parent</i>.</p>
<h3 class="fn"><a name="dtor.QtStateMachine"></a>QtStateMachine::~QtStateMachine ()</h3>
<p>Destroys this state machine.</p>
<h3 class="fn"><a name="addState"></a>void QtStateMachine::addState ( <a href="qtabstractstate.html">QtAbstractState</a> * <i>state</i> )</h3>
<p>Adds the given <i>state</i> to this state machine. The state becomes a top-level state (i.e&#x2e; a child of the <a href="qtstatemachine.html#rootState-prop">rootState</a>()).</p>
<p>If the state is already in a different machine, it will first be removed from its old machine, and then added to this machine.</p>
<p>See also <a href="qtstatemachine.html#removeState">removeState</a>() and <a href="qtstatemachine.html#rootState-prop">rootState</a>().</p>
<h3 class="fn"><a name="animationsFinished"></a>void QtStateMachine::animationsFinished ()&nbsp;&nbsp;<tt> [signal]</tt></h3>
<p>This signal is emitted when the state machine has finished playing all animations associated with the latest transition (i.e&#x2e;, all properties have reached their target values).</p>
<h3 class="fn"><a name="clearError"></a>void QtStateMachine::clearError ()</h3>
<p>Clears the error string and error code of the state machine.</p>
<h3 class="fn"><a name="error"></a><a href="qtstatemachine.html#Error-enum">Error</a> QtStateMachine::error () const</h3>
<p>Returns the error code of the last error that occurred in the state machine.</p>
<h3 class="fn"><a name="finished"></a>void QtStateMachine::finished ()&nbsp;&nbsp;<tt> [signal]</tt></h3>
<p>This signal is emitted when the state machine has reached a top-level final state.</p>
<p>See also <a href="qtstatemachine.html#started">QtStateMachine::started</a>().</p>
<h3 class="fn"><a name="globalRestorePolicy"></a><a href="qtabstractstate.html#RestorePolicy-enum">QtAbstractState::RestorePolicy</a> QtStateMachine::globalRestorePolicy () const</h3>
<p>Returns the global restore policy of the state machine.</p>
<p>See also <a href="qtstatemachine.html#setGlobalRestorePolicy">setGlobalRestorePolicy</a>() and <a href="qtabstractstate.html#restorePolicy-prop">QtActionState::restorePolicy</a>().</p>
<h3 class="fn"><a name="postEvent"></a>void QtStateMachine::postEvent ( <a href="http://doc.trolltech.com/4.4/qevent.html">QEvent</a> * <i>event</i>, int <i>delay</i> = 0 )</h3>
<p>Posts the given <i>event</i> for processing by this state machine, with a delay of <i>delay</i> milliseconds.</p>
<p>This function returns immediately. The event is added to the state machine's event queue. Events are processed in the order posted. The state machine takes ownership of the event and deletes it once it has been processed.</p>
<p>You can only post events when the state machine is running.</p>
<h3 class="fn"><a name="removeState"></a>void QtStateMachine::removeState ( <a href="qtabstractstate.html">QtAbstractState</a> * <i>state</i> )</h3>
<p>Removes the given <i>state</i> from this state machine. The state machine releases ownership of the state.</p>
<p>See also <a href="qtstatemachine.html#addState">addState</a>().</p>
<h3 class="fn"><a name="setGlobalRestorePolicy"></a>void QtStateMachine::setGlobalRestorePolicy ( <a href="qtabstractstate.html#RestorePolicy-enum">QtAbstractState::RestorePolicy</a> <i>restorePolicy</i> )</h3>
<p>Sets the global restore policy of the state machine to <i>restorePolicy</i>. The default global restore policy is <a href="qtabstractstate.html#RestorePolicy-enum">QtAbstractState::DoNotRestoreProperties</a>.</p>
<p>The global restore policy cannot be set to <a href="qtabstractstate.html#RestorePolicy-enum">QtAbstractState::GlobalRestorePolicy</a>.</p>
<p>See also <a href="qtstatemachine.html#globalRestorePolicy">globalRestorePolicy</a>() and <a href="qtabstractstate.html#restorePolicy-prop">QtAbstractState::setRestorePolicy</a>().</p>
<h3 class="fn"><a name="start"></a>void QtStateMachine::start ()&nbsp;&nbsp;<tt> [slot]</tt></h3>
<p>Starts this state machine. The machine will reset its configuration and transition to the initial state. When a final top-level state is entered, the machine will emit the <a href="qtstatemachine.html#finished">finished</a>() signal.</p>
<p>See also <a href="qtstatemachine.html#started">started</a>(), <a href="qtstatemachine.html#finished">finished</a>(), <a href="qtstatemachine.html#stop">stop</a>(), and <a href="qtstatemachine.html#initialState-prop">initialState</a>().</p>
<h3 class="fn"><a name="started"></a>void QtStateMachine::started ()&nbsp;&nbsp;<tt> [signal]</tt></h3>
<p>This signal is emitted when the state machine has entered its initial state.</p>
<p>See also <a href="qtstatemachine.html#finished">QtStateMachine::finished</a>() and <a href="qtstatemachine.html#start">QtStateMachine::start</a>().</p>
<h3 class="fn"><a name="states"></a><a href="http://doc.trolltech.com/4.4/qlist.html">QList</a>&lt;<a href="qtabstractstate.html">QtAbstractState</a> *&gt; QtStateMachine::states () const</h3>
<p>Returns the list of this state machine's states, or an empty list if the state machine has no states.</p>
<h3 class="fn"><a name="stop"></a>void QtStateMachine::stop ()&nbsp;&nbsp;<tt> [slot]</tt></h3>
<p>Stops this state machine.</p>
<p>See also <a href="qtstatemachine.html#stopped">stopped</a>().</p>
<h3 class="fn"><a name="stopped"></a>void QtStateMachine::stopped ()&nbsp;&nbsp;<tt> [signal]</tt></h3>
<p>This signal is emitted when the state machine has stopped.</p>
<p>See also <a href="qtstatemachine.html#stop">QtStateMachine::stop</a>().</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td width="30%" align="left">Copyright &copy; 2009 Nokia</td>
<td width="40%" align="center"><a href="http://doc.trolltech.com/trademarks.html">Trademarks</a></td>
<td width="30%" align="right"><div align="right">Qt Solutions</div></td>
</tr></table></div></address></body>
</html>
